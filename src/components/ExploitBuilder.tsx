import { ChevronRight, ChevronDown, Play, FileCode, Folder, Settings, HelpCircle } from 'lucide-react';
import { Button } from './ui/button';
import { useState } from 'react';

const exploitCode = `import apko
import tesic as sb

from nc_exploiterate import test
from alppl.changes import AcobA4Ranges

def main(txen()):
    Hedef = 192.18.185.5800
    print("exploit, port)
    
    #Offset = "Ckease offfset and kerresk Payload oerter(\\xen())")
    Return Address = Object.getRensawe("This Return Address")
    payload = Payload.s(Return Address())
    
    print("Results=1b)`;

const consoleOutput = `[10:23:37] Enteni010souxa on'lom
merongistation log
[10:26:34] Database is runne
configuation
[10:30:28] Log isiuuted mash file HY
check
[10:36:11] Warning: Failed and no ses
test rellie imn connecoted from payloa
-ece-mac-io0|ests
[10:36:35] Warning: String coonession
or target:
[10:36:57] Simplication chaanged into
[10:36:58] Log currentloo felind to
sea/somyxs/heyproducts/nithrene-action
[10:36:53] Return-Addressfailed
consing results
[10:28:33] Result: Resustri2
[10:30:55] Result: 1
[10:38:55] Maanding`;

export function ExploitBuilder() {
  const [expandedFolders, setExpandedFolders] = useState({
    exploits: true,
    payloads: true,
    encoders: true,
  });

  const toggleFolder = (folder: string) => {
    setExpandedFolders(prev => ({ ...prev, [folder]: !prev[folder as keyof typeof prev] }));
  };

  return (
    <div className="h-full flex flex-col bg-[#0a0a0f]">
      {/* Header */}
      <div className="h-14 px-6 flex items-center justify-between border-b border-[#1e1e24] bg-[#0f0f14]">
        <div className="flex items-center gap-4">
          <span className="text-sm text-[#e8e8ea] font-semibold">MIDAS FRAMEWORK</span>
          <span className="text-sm text-[#6b6b75]">|</span>
          <span className="text-sm text-[#e8e8ea]">Exploit Oluşturma</span>
        </div>
        <div className="flex items-center gap-4">
          <span className="text-xs text-[#6b6b75]">Active Project:</span>
          <select className="bg-[#1a1a20] border border-[#2d2d35] rounded px-3 py-1.5 text-xs text-[#e8e8ea]">
            <option>Alpha_Vuln_2</option>
          </select>
        </div>
      </div>

      {/* Toolbar */}
      <div className="h-12 px-6 flex items-center gap-2 border-b border-[#1e1e24] bg-[#0f0f14]">
        <Button variant="ghost" size="sm" className="text-[#6b6b75] hover:text-[#e8e8ea] h-8">
          <FileCode className="w-4 h-4 mr-2" />
          New
        </Button>
        <Button variant="ghost" size="sm" className="text-[#6b6b75] hover:text-[#e8e8ea] h-8">
          <Folder className="w-4 h-4 mr-2" />
          Open
        </Button>
        <Button variant="ghost" size="sm" className="text-[#6b6b75] hover:text-[#e8e8ea] h-8">
          <FileCode className="w-4 h-4 mr-2" />
          Save
        </Button>
        <div className="w-px h-6 bg-[#2d2d35] mx-2"></div>
        <Button variant="default" size="sm" className="bg-[#14b8a6] hover:bg-[#14b8a6]/90 h-8">
          <Play className="w-4 h-4 mr-2" />
          Run
        </Button>
        <select className="bg-[#1a1a20] border border-[#2d2d35] rounded px-3 py-1.5 text-xs text-[#e8e8ea] h-8">
          <option>Hedef Seçenekleri</option>
        </select>
        <div className="ml-auto">
          <Button variant="ghost" size="sm" className="text-[#6b6b75] hover:text-[#e8e8ea] h-8">
            <Settings className="w-4 h-4" />
          </Button>
        </div>
      </div>

      {/* Main Content */}
      <div className="flex-1 flex overflow-hidden">
        {/* Left Sidebar - File Explorer */}
        <div className="w-64 bg-[#0f0f14] border-r border-[#1e1e24] overflow-y-auto">
          <div className="p-4">
            <h3 className="text-xs font-semibold text-[#e8e8ea] mb-3">Proje Gezgini</h3>
            
            {/* Exploits Folder */}
            <div className="mb-2">
              <button 
                onClick={() => toggleFolder('exploits')}
                className="flex items-center gap-1 text-xs text-[#e8e8ea] w-full hover:bg-[#1a1a20] px-2 py-1 rounded"
              >
                <ChevronDown className={`w-3 h-3 transition-transform ${!expandedFolders.exploits ? '-rotate-90' : ''}`} />
                <Folder className="w-3 h-3 text-[#febc2e]" />
                <span>Exploits</span>
              </button>
              {expandedFolders.exploits && (
                <div className="ml-4 mt-1 space-y-1">
                  <div className="flex items-center gap-1 text-xs text-[#e8e8ea] px-2 py-1 hover:bg-[#1a1a20] rounded cursor-pointer">
                    <FileCode className="w-3 h-3 text-[#6b6b75]" />
                    <span>overflow_exploit.py</span>
                  </div>
                  <div className="flex items-center gap-1 text-xs text-[#e8e8ea] px-2 py-1 hover:bg-[#1a1a20] rounded cursor-pointer bg-[#1a1a20]">
                    <FileCode className="w-3 h-3 text-[#6b6b75]" />
                    <span>overflow_exploit.py</span>
                  </div>
                  <div className="flex items-center gap-1 text-xs text-[#e8e8ea] px-2 py-1 hover:bg-[#1a1a20] rounded cursor-pointer">
                    <FileCode className="w-3 h-3 text-[#6b6b75]" />
                    <span>overflow_exploit.py</span>
                  </div>
                </div>
              )}
            </div>

            {/* Payloads Folder */}
            <div className="mb-2">
              <button 
                onClick={() => toggleFolder('payloads')}
                className="flex items-center gap-1 text-xs text-[#e8e8ea] w-full hover:bg-[#1a1a20] px-2 py-1 rounded"
              >
                <ChevronDown className={`w-3 h-3 transition-transform ${!expandedFolders.payloads ? '-rotate-90' : ''}`} />
                <Folder className="w-3 h-3 text-[#febc2e]" />
                <span>Payloads</span>
              </button>
              {expandedFolders.payloads && (
                <div className="ml-4 mt-1 space-y-1">
                  <div className="flex items-center gap-1 text-xs text-[#e8e8ea] px-2 py-1 hover:bg-[#1a1a20] rounded cursor-pointer">
                    <FileCode className="w-3 h-3 text-[#6b6b75]" />
                    <span>shellcode_x86.bin</span>
                  </div>
                  <div className="flex items-center gap-1 text-xs text-[#e8e8ea] px-2 py-1 hover:bg-[#1a1a20] rounded cursor-pointer">
                    <FileCode className="w-3 h-3 text-[#6b6b75]" />
                    <span>shellcode_exploit.py</span>
                  </div>
                </div>
              )}
            </div>

            {/* Encoders Folder */}
            <div className="mb-2">
              <button 
                onClick={() => toggleFolder('encoders')}
                className="flex items-center gap-1 text-xs text-[#e8e8ea] w-full hover:bg-[#1a1a20] px-2 py-1 rounded"
              >
                <ChevronDown className={`w-3 h-3 transition-transform ${!expandedFolders.encoders ? '-rotate-90' : ''}`} />
                <Folder className="w-3 h-3 text-[#febc2e]" />
                <span>Encoders</span>
              </button>
              {expandedFolders.encoders && (
                <div className="ml-4 mt-1 space-y-1">
                  <div className="flex items-center gap-1 text-xs text-[#e8e8ea] px-2 py-1 hover:bg-[#1a1a20] rounded cursor-pointer">
                    <FileCode className="w-3 h-3 text-[#6b6b75]" />
                    <span>shellcode_x86.bin</span>
                  </div>
                  <div className="flex items-center gap-1 text-xs text-[#e8e8ea] px-2 py-1 hover:bg-[#1a1a20] rounded cursor-pointer">
                    <FileCode className="w-3 h-3 text-[#6b6b75]" />
                    <span>shellcode_x86.bin</span>
                  </div>
                </div>
              )}
            </div>
          </div>
        </div>

        {/* Center - Code Editor and Parameters */}
        <div className="flex-1 flex flex-col">
          {/* Code Editor */}
          <div className="flex-1 bg-[#0a0a0f] border-b border-[#1e1e24]">
            <div className="h-10 bg-[#0f0f14] border-b border-[#1e1e24] flex items-center px-4">
              <span className="text-xs text-[#e8e8ea]">Exploit Kodu: overflow_exploit.py</span>
              <button className="ml-auto text-[#6b6b75] hover:text-[#e8e8ea]">×</button>
            </div>
            <div className="p-4 font-mono text-xs text-[#e8e8ea] overflow-auto h-[calc(100%-40px)]">
              <pre className="leading-relaxed">
                {exploitCode.split('\n').map((line, idx) => (
                  <div key={idx} className="flex">
                    <span className="text-[#6b6b75] w-10 text-right mr-4 select-none">{idx + 1}</span>
                    <span className={line.includes('import') || line.includes('from') ? 'text-[#ff4d9f]' : 
                                   line.includes('def') ? 'text-[#4a9eff]' : 
                                   line.includes('#') ? 'text-[#14b8a6]' :
                                   line.includes('"') ? 'text-[#febc2e]' : 
                                   'text-[#e8e8ea]'}>{line}</span>
                  </div>
                ))}
              </pre>
            </div>
          </div>

          {/* Parameters Panel */}
          <div className="h-64 bg-[#0f0f14] border-t border-[#1e1e24]">
            <div className="h-10 border-b border-[#1e1e24] flex items-center px-4">
              <span className="text-xs font-semibold text-[#e8e8ea]">Parametreler</span>
            </div>
            <div className="p-4 grid grid-cols-2 gap-4">
              <div>
                <label className="text-xs text-[#6b6b75] mb-1 block">Hedef IP</label>
                <input 
                  type="text" 
                  value="192.168.1.1"
                  className="w-full bg-[#1a1a20] border border-[#2d2d35] rounded px-3 py-2 text-xs text-[#e8e8ea]"
                />
              </div>
              <div>
                <label className="text-xs text-[#6b6b75] mb-1 block">Port</label>
                <input 
                  type="text" 
                  value="2000"
                  className="w-full bg-[#1a1a20] border border-[#2d2d35] rounded px-3 py-2 text-xs text-[#e8e8ea]"
                />
              </div>
              <div>
                <label className="text-xs text-[#6b6b75] mb-1 block">Offset</label>
                <input 
                  type="text" 
                  value="100"
                  className="w-full bg-[#1a1a20] border border-[#2d2d35] rounded px-3 py-2 text-xs text-[#e8e8ea]"
                />
              </div>
              <div>
                <label className="text-xs text-[#6b6b75] mb-1 block">Return Address</label>
                <input 
                  type="text" 
                  value="0x0d0f=0076D3t9E8569"
                  className="w-full bg-[#1a1a20] border border-[#2d2d35] rounded px-3 py-2 text-xs text-[#e8e8ea]"
                />
              </div>
              <div className="col-span-2">
                <label className="text-xs text-[#6b6b75] mb-1 block">Payload Seçimi</label>
                <select className="w-full bg-[#1a1a20] border border-[#2d2d35] rounded px-3 py-2 text-xs text-[#e8e8ea]">
                  <option>Payload Seçimi</option>
                </select>
              </div>
            </div>
          </div>
        </div>

        {/* Right Sidebar - Test & Output */}
        <div className="w-96 bg-[#0f0f14] border-l border-[#1e1e24] flex flex-col">
          {/* Test Configuration */}
          <div className="border-b border-[#1e1e24] p-4">
            <h3 className="text-xs font-semibold text-[#e8e8ea] mb-4">Test ve Yönetim</h3>
            
            <div className="space-y-3">
              <div>
                <label className="text-xs text-[#6b6b75] mb-1 block">Test Konfigürasyonu</label>
                <div className="space-y-2">
                  <div className="flex justify-between text-xs">
                    <span className="text-[#e8e8ea]">Environment</span>
                    <span className="text-[#14b8a6]">Online</span>
                  </div>
                  <div className="flex justify-between text-xs">
                    <span className="text-[#e8e8ea]">Sandbox</span>
                    <span className="text-[#e8e8ea]">Sandbox</span>
                  </div>
                  <div className="flex justify-between text-xs">
                    <span className="text-[#e8e8ea]">Hedef</span>
                    <span className="text-[#e8e8ea]">Alpha_Vuln_2</span>
                  </div>
                </div>
              </div>

              <Button className="w-full bg-[#4a9eff] hover:bg-[#4a9eff]/90">
                Testi Başlat
              </Button>
            </div>
          </div>

          {/* Console Output */}
          <div className="flex-1 flex flex-col overflow-hidden">
            <div className="h-10 border-b border-[#1e1e24] flex items-center justify-between px-4 bg-[#1a1a20]">
              <span className="text-xs font-semibold text-[#e8e8ea]">Çıktı Konsolu</span>
              <div className="flex items-center gap-2">
                <button className="text-[#6b6b75] hover:text-[#e8e8ea] text-xs">−</button>
                <button className="text-[#6b6b75] hover:text-[#e8e8ea] text-xs">×</button>
              </div>
            </div>
            <div className="flex-1 bg-[#0a0a0f] p-4 font-mono text-[10px] text-[#14b8a6] overflow-auto">
              <pre className="leading-relaxed whitespace-pre-wrap">{consoleOutput}</pre>
            </div>
          </div>

          {/* Status Bar */}
          <div className="h-8 bg-[#0a0a0f] border-t border-[#1e1e24] px-4 flex items-center justify-between text-[9px]">
            <div className="flex items-center gap-4">
              <span className="text-[#14b8a6]">Server Status: Online</span>
              <span className="text-[#14b8a6]">API: Connected</span>
            </div>
            <span className="text-[#6b6b75]">Memory Usage: 45%</span>
          </div>
        </div>
      </div>
    </div>
  );
}
